<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui">
<h:head>
	<title>Listado de Personas</title>
</h:head>
<h:body>

	<div id="top" class="ui-widget-header ui-corner-all">
		<ui:insert name="top">Top</ui:insert>
	</div>
	
	<div id="menu">
		<h:form>  	 
		    <p:menubar>
		        <p:submenu label="File" icon="pi pi-file">
		            <p:submenu label="New" icon="pi pi-briefcase">
		                <p:menuitem value="Project" url="#" />
		                <p:menuitem value="Other" url="#" />
		            </p:submenu>
		            <p:menuitem value="Open" url="#" />
		            <p:separator />
		            <p:menuitem value="Quit" url="#" />
		        </p:submenu>
		 
		        <p:submenu label="Edit" icon="pi pi-pencil">
		            <p:menuitem value="Undo" url="#" icon="pi pi-angle-double-left" />
		            <p:menuitem value="Redo" url="#" icon="pi pi-angle-double-right" />
		        </p:submenu>
		 
		        <p:submenu label="Help" icon="pi pi-question">
		            <p:menuitem value="Contents" url="#" />
		            <p:submenu label="Search" icon="pi pi-search">
		                <p:submenu label="Text">
		                    <p:menuitem value="Workspace" url="#" />
		                </p:submenu>
		                <p:menuitem value="File" url="#" />
		            </p:submenu>
		        </p:submenu>
		 
		        <p:submenu label="Actions" icon="pi pi-cog">
		            <p:submenu label="Ajax" icon="pi pi-refresh">
		                <p:menuitem value="Save" action="#{menuView.save}" icon="pi pi-save"/>
		                <p:menuitem value="Update" action="#{menuView.update}" icon="pi pi-refresh"/>
		            </p:submenu>
		            <p:submenu label="Non-Ajax" icon="pi pi-clone">
		                <p:menuitem value="Delete" action="#{menuView.delete}" icon="pi pi-times" ajax="false"/>
		            </p:submenu>
		        </p:submenu>
		 
		        <p:menuitem value="Quit" url="http://www.primefaces.org" icon="pi pi-times" />
		 
		        <f:facet name="options">
		            <p:inputText style="margin:1px 10px 1px 1px;" placeholder="Search"/>
		            <p:commandButton type="button" value="Logout" icon="pi pi-home" />
		        </f:facet>
		    </p:menubar>
		</h:form>
	</div>

	<div id="content" class="center_content">
		<h:form id="personasListForm">
			<p:growl id="messages" showDetail="true" />
			<p:messages />
	
			<!-- Tabla Listar personas -->
			<p:dataTable id="personasDataTable" value="#{personaBean.personas}"
				var="persona" editable="true" rowKey="#{persona.idPersona}"
				selection="#{personaBean.personaSeleccionada}" selectionMode="single"
				paginator="true" rows="10" paginatorPosition="bottom"
				paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
				currentPageReportTemplate="{startRecord}-{endRecord} of {totalRecords} records">
				<f:facet name="header">
					Listado de Personas
				</f:facet>
	
				<p:column headerText="Id">
					<h:outputText value="#{persona.idPersona}" />
				</p:column>
	
				<p:column headerText="Nombre" filterBy="#{persona.nombre}" footerText="contains" filterMatchMode="contains">
					<p:cellEditor>
						<f:facet name="output">
							<h:outputText value="#{persona.nombre}" />
						</f:facet>
						<f:facet name="input">
							<p:inputText value="#{persona.nombre}" />
						</f:facet>
					</p:cellEditor>
				</p:column>
	
				<p:column headerText="Apellido" filterBy="#{persona.apellido}" footerText="contains" filterMatchMode="contains">
					<p:cellEditor>
						<f:facet name="output">
							<h:outputText value="#{persona.apellido}" />
						</f:facet>
						<f:facet name="input">
							<p:inputText value="#{persona.apellido}" />
						</f:facet>
					</p:cellEditor>
				</p:column>
	
				<p:column headerText="Email" filterBy="#{persona.email}" footerText="contains" filterMatchMode="contains">
					<p:cellEditor>
						<f:facet name="output">
							<h:outputText value="#{persona.email}" />
						</f:facet>
						<f:facet name="input">
							<p:inputText value="#{persona.email}" />
						</f:facet>
					</p:cellEditor>
				</p:column>
	
				<p:column headerText="Telefono" filterBy="#{persona.telefono}" footerText="contains" filterMatchMode="contains">
					<p:cellEditor>
						<f:facet name="output">
							<h:outputText value="#{persona.telefono}" />
						</f:facet>
						<f:facet name="input">
							<p:inputText value="#{persona.telefono}" />
						</f:facet>
					</p:cellEditor>
				</p:column>
	
				<f:facet name="footer">
					<p:commandButton value="Salir" action="logout" />
					<p:spacer height="5px" />
					<p:commandButton value="Agregar"
						actionListener="#{personaBean.reiniciarPersonaSeleccionada}"
						update=":dialogForm" oncomplete="PF('personaDialog').show()" />
				</f:facet>
	
				<p:column headerText="Opciones" style="width: 50px">
					<p:rowEditor />
				</p:column>
	
				<p:ajax event="rowEdit" listener="#{personaBean.editListener}" />
	
			</p:dataTable>
			<!-- Fin Listar Personas -->
	
			<p:contextMenu for="personasDataTable">
				<p:menuitem value="Ver" update="personasListForm:personasDataTable" icon="ui-icon-view" oncomplete="PF('personaSeleccionada').show()" />
				<p:menuitem value="Eliminar" update="personasListForm:personasDataTable" icon="ui-icon-close" actionListener="#{personaBean.eliminarPersona}" />
			</p:contextMenu>

	</h:form>

	<!-- Agregar persona Menú -->
	<p:dialog id="personaDlg" widgetVar="personaDialog" header="Agregar Persona" modal="true" showEffect="fade" hideEffect="fade" resizable="false">
		<h:form id="dialogForm">
			<p:outputPanel id="personaDetail" style="text-align: center;">
				<p:panelGrid id="display" columns="4" columnClasses="label,value">
					<h:outputText for="nombre" value="Nombre" />
					<h:inputText style="#{ component.valid ? 'border-color:red;' : 'border-color:red;'}" value="#{personaBean.personaSeleccionada.nombre}" label="Nombre" required="true">
						<f:validateLength minimum="2" />
					</h:inputText>
					
					<h:outputText for="apellido" value="Apellido" />
					<h:inputText style="#{ component.valid ? 'border-color:red;' : 'border-color:red;'}" value="#{personaBean.personaSeleccionada.apellido}" label="Apellido" required="true">
						<f:validateLength minimum="2" />
					</h:inputText>

					<h:outputText for="email" value="Email" />
					<h:inputText style="#{ component.valid ? 'border-color:red;' : 'border-color:red;'}" value="#{personaBean.personaSeleccionada.email}" label="Email" required="true">
						<f:validateLength minimum="6" />
					</h:inputText>
					
					<h:outputText for="email" value="Telefono" />
					<h:inputText style="#{ component.valid ? 'border-color:red;' : 'border-color:red;'}" value="#{personaBean.personaSeleccionada.telefono}" label="Telefono" required="true">
							<f:validateLength minimum="8" />
					</h:inputText>

					<f:facet name="footer">
						<p:commandButton value="Agregar" actionListener="#{personaBean.agregarPersona}" update="display,:personasListForm:personasDataTable" oncomplete="PF('personaDialog').hide();" />
					</f:facet>
				</p:panelGrid>
			</p:outputPanel>
		</h:form>
	</p:dialog>
	<!-- Fin Agregar persona Menú -->
	
	<!-- Ver persona Menú -->
	<p:dialog widgetVar="personaSeleccionada" header="Ver persona" modal="true" showEffect="fade" hideEffect="fade" resizable="false">
		<h:form id="dialogForm1">
			<p:outputPanel id="personaDetail" style="text-align:center;">
				<p:panelGrid id="display" columns="2" rendered="#{not empty personaBean.personaSeleccionada}" columnClasses="label,value">
					<f:facet name="header">
						<p:graphicImage library="images" name="ajaxloading.gif" />
					</f:facet>
					
					<h:outputText value="Nombre" />
					<h:outputText value="#{personaBean.personaSeleccionada.nombre}" />

					<h:outputText value="Apellido" />
					<h:outputText value="#{personaBean.personaSeleccionada.apellido}" />

					<h:outputText value="Email" />
					<h:outputText value="#{personaBean.personaSeleccionada.email}" />

					<h:outputText for="telefono" value="Telefono" />
					<h:outputText value="#{personaBean.personaSeleccionada.telefono}" />
				</p:panelGrid>
			</p:outputPanel>
		</h:form>
	</p:dialog>
	<!-- Fin Ver persona Menú -->
	</div>
		
	<div id="bottom" class="ui-widget-header ui-corner-all">
		<ui:insert name="bottom">&copy; 2020</ui:insert>
	</div>
</h:body>
</html>